(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5385e5f0"],{"0da0":function(t,i,e){"use strict";var s=e("3a68"),n=e.n(s);n.a},"1f9e":function(t,i,e){},"3a68":function(t,i,e){},"5a4e":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return t.posts.length>0||!t.isPostLoadClear||t.getPermissionCreate?e("div",{staticClass:"timeline"},[e("div",{staticClass:"timeline__wrapper"},[t.getPermissionCreate?e("Post",{attrs:{isCreate:!0},on:{isChange:t.reload}}):t._e(),e("transition-group",{attrs:{name:"timeline"}},t._l(t.posts,(function(i){return e("Post",{key:i._id,staticClass:"timeline__post",attrs:{data:i},on:{isChange:t.reload}})})),1)],1)]):e("div",{staticClass:"timeline__notfound"},[t._v("타임라인에 작성된 글이 없습니다.")])},n=[],a=(e("7514"),e("2b0e")),o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"post",class:{"post-modif":t.isModifPost,"post-loading":t.isLoading}},[t.isShowOption?e("div",{staticClass:"post__option"},[t.isModifPost?t._e():e("p",{on:{click:t.modifPost}},[e("i",{staticClass:"mdi mdi-pencil"}),e("span",[t._v("수정")])]),e("p",{staticClass:"delete",on:{click:t.deletePost}},[e("i",{staticClass:"mdi mdi-delete"}),e("span",[t._v("삭제")])])]):t._e(),t.isCreate?t._e():e("h3",{staticClass:"post__title"},[e("img",{attrs:{src:t.data.owner.imgPath?t.getMainPath+t.data.owner.imgPath:"https://pbs.twimg.com/profile_images/770139154898382848/ndFg-IDH_400x400.jpg",alt:"user_profile"}}),e("p",[e("span",{staticClass:"clubname"},[t._v(t._s(t.data.owner.name))]),t._v(" 님이 "),t.data.imgPath.length?e("span",[t._v("사진 "+t._s(t.data.imgPath.length)+"장을 업로드했습니다.")]):e("span",[t._v("글을 업로드했습니다.")]),e("br"),e("span",{staticClass:"moment"},[t._v(t._s(t.data.timeString))])]),t.getPermissionModifAndDelete?e("i",{staticClass:"mdi mdi-dots-horizontal post__menu",on:{click:t.toggleOption}}):t._e()]),t.isModifPost?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.modifContent,expression:"modifContent"}],staticClass:"post__content create",attrs:{placeholder:"글 작성하기"},domProps:{value:t.modifContent},on:{keypress:t.pressEnter,input:function(i){i.target.composing||(t.modifContent=i.target.value)}}}):e("pre",{staticClass:"post__content"},[t._v(t._s(t.data.content))]),t._v(" "),!t.isCreate&&t.data&&t.data.imgPath.length?e("article",{staticClass:"post__image"},[e("div",{staticClass:"post__image__mainImage"},[e("img",{attrs:{src:t.getMainPath+t.data.imgPath[0],alt:"content_image"}})]),t.data.imgPath.length>2?e("div",{staticClass:"post__image__sublist"},[e("div",{staticClass:"post__image__subImage"},[e("img",{attrs:{src:t.getMainPath+t.data.imgPath[1],alt:"content_image"}})]),e("div",{staticClass:"post__image__subImage"},[e("img",{attrs:{src:t.getMainPath+t.data.imgPath[1],alt:"content_image"}})])]):t._e()]):t._e(),t.isModifPost?e("div",{staticClass:"post__modifaction"},[e("div",{staticClass:"post__modifaction__wrapper"},[e("span",{staticClass:"post__modifaction__image"},[e("label",[e("input",{attrs:{type:"file",name:"img",accept:"image/*",multiple:""},on:{change:t.onImageChange}}),t._m(0),e("div",{staticClass:"post__modification__image__imagenames"},t._l(t.getImages,(function(i,s){return e("span",{key:s,staticClass:"imagename"},[t._v(t._s(i.name))])})),0)])]),e("div",[t.isCreate?t._e():e("span",{staticStyle:{color:"#e02020","margin-right":"20px"},on:{click:t.modifPost}},[t._v("취소")]),e("span",{staticStyle:{color:"#538fff"},on:{click:t.changeContentSave}},[t._v(t._s(t.isCreate?"작성":"확인"))])])])]):t.isCreate?t._e():e("div",{staticClass:"post__action"},[e("p",{staticClass:"post__action__heart",on:{click:t.toggleLike}},[e("i",{staticClass:"mdi",class:t.isLike?"mdi-heart":"mdi-heart-outline"}),t._v(" "+t._s(t.data.likes.length)+" ")]),e("p",{staticClass:"post__action__comment",on:{click:t.toggleComments}},[e("i",{staticClass:"mdi mdi-comment"}),t._v(" "+t._s(t.comments.length?t.comments.length:t.data.comments.length)+" ")])]),!t.isModifPost&&t.isShowComments?e("div",{staticClass:"post__comments"},[e("div",{staticClass:"post__comments__editwrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],attrs:{type:"text"},domProps:{value:t.comment},on:{keydown:t.pressEnterComment,input:function(i){i.target.composing||(t.comment=i.target.value)}}}),e("button",{on:{click:t.createComment}},[t._v("작성")])]),e("div",{staticClass:"post__comments__list"},t._l(t.comments,(function(i){return e("div",{key:i._id,staticClass:"post__comments__list__item"},[e("h4",[e("img",{attrs:{src:i.owner.imgPath?t.getMainPath+i.owner.imgPath:"https://pbs.twimg.com/profile_images/770139154898382848/ndFg-IDH_400x400.jpg",alt:""}}),t._v(" "+t._s(i.owner.name)+" ")]),e("p",[t._v(t._s(i.message))]),t.checkOwner(i.owner)?e("div",{staticClass:"post__comments__list__item__remove",on:{click:function(e){return t.removeComment(i._id)}}},[e("i",{staticClass:"mdi mdi-close"})]):t._e()])})),0)]):t._e(),t.isLoading?e("TopLoadingBar",{staticClass:"post__loading"}):t._e()],1)},r=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"post__modifaction__image__button"},[e("i",{staticClass:"mdi mdi-image-plus"})])}],c=(e("5df3"),e("75fc")),m=(e("ac6a"),e("d976")),d=a["a"].extend({components:{TopLoadingBar:m["a"]},props:{data:Object,isCreate:Boolean},data:function(){return{isShowOption:!1,isModifPost:!1,modifContent:"",comment:"",comments:[],isShowComments:!1,images:[],base64images:[],isLoading:!1}},created:function(){this.isCreate&&(this.isModifPost=!0)},methods:{toggleOption:function(){this.isShowOption=!this.isShowOption},toggleComments:function(){this.isShowComments=!this.isShowComments,this.isShowComments&&this.comments&&this.commentReload()},commentReload:function(){var t=this;this.isLoading=!0,this.$store.dispatch("POST_COMMENT",{_id:this.data._id}).then((function(i){t.isLoading=!1,t.comments=i.reverse()})).catch((function(t){return console.log(t)}))},deletePost:function(){var t=this;this.isLoading||(this.isLoading=!0,this.$store.dispatch("POST_DELETE",{_id:this.data._id}).then((function(i){t.isLoading=!1,t.$emit("isChange",!1)})).catch((function(t){return console.log(t)})))},modifPost:function(){this.modifContent=this.data.content,this.isShowOption=!1,this.isModifPost=!this.isModifPost},changeContentSave:function(){var t=this;this.modifContent.trim().length>0&&(this.isLoading=!0,this.isCreate?this.images?this.encodeBase64ImageFiles(this.images).then((function(i){t.$store.dispatch("POST_WRITE",{content:t.modifContent,img:i}).then((function(i){t.images=[],t.isLoading=!1,t.modifContent="",t.$emit("isChange",!1)})).catch((function(t){return console.log(t)}))})).catch((function(t){return console.log(t)})):this.$store.dispatch("POST_WRITE",{content:this.modifContent}).then((function(i){t.isLoading=!1,t.modifContent="",t.$emit("isChange",!1)})).catch((function(t){return console.log(t)})):this.$store.dispatch("POST_MODIFICATION",{_id:this.data._id,content:this.modifContent}).then((function(i){t.isLoading=!1,t.isShowOption=!1,t.isModifPost=!1,t.$emit("isChange",!1)})).catch((function(t){return console.log(t)})))},pressEnter:function(t){10==t.keyCode&&t.ctrlKey&&this.changeContentSave()},pressEnterComment:function(t){13==t.keyCode&&this.createComment()},createComment:function(){var t=this;!this.isLoading&&this.comment.trim().length>0&&(this.isLoading=!0,this.$store.dispatch("POST_COMMENT_WRITE",{_id:this.data._id,message:this.comment}).then((function(){t.isLoading=!1,t.comment="",t.commentReload()})).catch((function(t){})))},removeComment:function(t){var i=this;this.isLoading||(this.isLoading=!0,this.$store.dispatch("POST_COMMENT_DELETE",{_id:t,_postid:this.data._id}).then((function(){i.isLoading=!1,i.commentReload()})).catch((function(t){})))},toggleLike:function(){var t=this;this.isLoading||(this.isLoading=!0,this.$store.dispatch("POST_TOGGLE_LIKE",{_id:this.data._id}).then((function(){t.isLoading=!1,t.$emit("isChange",!1)})).catch((function(t){})))},onImageChange:function(t){this.images=t.target.files,this.encodeBase64ImageFiles(this.images)},encodeBase64ImageFile:function(t){return new Promise((function(i,e){var s=new FileReader;s.readAsDataURL(t),s.onload=function(t){i(t.target.result)},s.onerror=function(t){e(t)}}))},encodeBase64ImageFiles:function(t){var i=this,e=[];return Object(c["a"])(t).forEach((function(t){e.push(i.encodeBase64ImageFile(t))})),Promise.all(e)},checkOwner:function(t){return this.getUserInformation._id==t._id}},computed:{getImages:function(){return Object(c["a"])(this.images)},getMainPath:function(){return this.$store.state.mainPath},getUserInformation:function(){return this.$store.state.userInformation},getClub:function(){return this.$store.state.club},isLike:function(){return!!this.getUserInformation&&-1!=this.data.likes.indexOf(this.getUserInformation._id)},getPermissionModifAndDelete:function(){var t=this;if(this.getUserInformation._id==this.data.owner._id)return!0;if(this.getClub.ranks){if(this.getClub.owner==this.$store.state.userInformation._id)return!0;var i=this.getClub.members.find((function(i){return i.user==t.$store.state.userInformation._id}));if(i){var e=this.getClub.ranks.find((function(t){return t.id==i.rank})).permission;return-1!=e.indexOf(3)}return!1}return!1}}}),l=d,_=(e("9b8a"),e("2877")),h=Object(_["a"])(l,o,r,!1,null,null,null),g=h.exports,u=a["a"].extend({name:"Timeline",components:{Post:g},data:function(){return{posts:[],isPostLoadClear:!1}},created:function(){this.reload()},methods:{reload:function(){var t=this;this.$store.commit("pushPageLoading",{name:"GET_CLUB_POSTS",message:"동아리 글 불러오는 중"}),this.$store.dispatch("GET_CLUB_POSTS").then((function(i){t.$store.commit("clearPageLoading","GET_CLUB_POSTS"),t.isPostLoadClear=!0,t.posts=i})).catch((function(t){}))}},computed:{getClub:function(){return this.$store.state.club},getPermissionCreate:function(){var t=this;if(this.getClub.ranks){if(this.getClub.owner==this.$store.state.userInformation._id)return!0;var i=this.getClub.members.find((function(i){return i.user==t.$store.state.userInformation._id}));if(i){var e=this.getClub.ranks.find((function(t){return t.id==i.rank})).permission.map((function(t){return parseInt(t)}));return-1!=e.indexOf(1)}return!1}return!1}}}),f=u,p=(e("0da0"),Object(_["a"])(f,s,n,!1,null,null,null));i["default"]=p.exports},"5df3":function(t,i,e){"use strict";var s=e("02f4")(!0);e("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,i=this._t,e=this._i;return e>=i.length?{value:void 0,done:!0}:(t=s(i,e),this._i+=t.length,{value:t,done:!1})}))},"9b8a":function(t,i,e){"use strict";var s=e("1f9e"),n=e.n(s);n.a}}]);
//# sourceMappingURL=chunk-5385e5f0.ea4c75cd.js.map